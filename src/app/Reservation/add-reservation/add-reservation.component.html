<div class="p-grid p-flex-column">
    <div class="p-col">
        <div class="box">
            <div class="p-text-center" ><h2>AÃ±adir reserva</h2></div>
            <i class="pi pi-check"></i>
        </div>
    </div>
    <div class="p-col">
        <div class="p-grid">
            <div class="p-col-3" *ngFor="let f of (fields$ | async)">
                <div class="box box-stretched">
                    <p-card header="{{f.fieldType?.name}}"
                        subheader="{{f.amount | currency:'CLP':'symbol-narrow':'1.0-0'}}" [style]="{width: '360px'}"
                        styleClass="p-card-shadow">
                        <ng-template pTemplate="header">
                            <img alt="Card" src="{{ f.fieldType.idFieldType | imageResource }}" style="width: fit-content;">
                        </ng-template>
                        <ng-template pTemplate="footer">
                            <!--Abrir modal disponibilidad-->
                            <p-button (click)="showDialog(f)" label="Reservar" icon="pi pi-envelope"
                                styleClass="p-button-secondary"></p-button>                            
                        </ng-template>
                    </p-card>
                </div>
            </div>

            <!-- Modal disponibilidad -->
            <p-dialog header="Disponibilidad" [(visible)]="display" [style]="{width: '50vw'}"
                [baseZIndex]="10000"> 
                <p-calendar [(ngModel)]="dateModel" [inline]="true" [minDate]="dateMin" [maxDate]="dateMax"
                (onSelect)="onSelect(fieldModel)"></p-calendar>
                <h5>Bloques disponibles</h5>
                <p-listbox [options]="schedules" [(ngModel)]="scheduleModel" optionLabel="initTime" [style]="{'width':'15rem'}"
                emptyMessage="No hay horas disponibles"></p-listbox>
                <ng-template pTemplate="footer">
                    <p-button icon="pi pi-check" (click)="ngOnSubmit()" label="Reservar"></p-button>
                    <p-button icon="pi pi-times" (click)="display=false" label="Cancelar" styleClass="p-button-text"></p-button>
                </ng-template>
            </p-dialog>
            <p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000"></p-confirmDialog>
            <p-messages [value]="msgs" [style]="{width: '20vw'}"></p-messages>
        </div>
    </div>
    <div class="p-col">
    </div>
</div>